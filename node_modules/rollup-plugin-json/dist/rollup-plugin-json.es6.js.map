{"version":3,"file":"rollup-plugin-json.es6.js","sources":["..//Volumes/Storage/www/ROLLUP/plugins/rollup-plugin-json/src/index.js"],"sourcesContent":["import { createFilter, makeLegalIdentifier } from 'rollup-pluginutils';\n\nexport default function json ( options = {} ) {\n\tconst filter = createFilter( options.include, options.exclude );\n\n\treturn {\n\t\ttransform ( json, id ) {\n\t\t\tif ( id.slice( -5 ) !== '.json' ) return null;\n\t\t\tif ( !filter( id ) ) return null;\n\n\t\t\tlet code;\n\t\t\tlet ast = {\n\t\t\t\ttype: 'Program',\n\t\t\t\tsourceType: 'module',\n\t\t\t\tstart: 0,\n\t\t\t\tend: null,\n\t\t\t\tbody: []\n\t\t\t};\n\n\t\t\tif ( json[0] !== '{' ) {\n\t\t\t\tcode = `export default ${json};`;\n\n\t\t\t\tast.body.push({\n\t\t\t\t\ttype: 'ExportDefaultDeclaration',\n\t\t\t\t\tstart: 0,\n\t\t\t\t\tend: code.length,\n\t\t\t\t\tdeclaration: {\n\t\t\t\t\t\ttype: 'Literal',\n\t\t\t\t\t\tstart: 15,\n\t\t\t\t\t\tend: code.length - 1,\n\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\traw: 'null'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst data = JSON.parse( json );\n\n\t\t\t\tconst validKeys = [];\n\t\t\t\tconst invalidKeys = [];\n\n\t\t\t\tObject.keys( data ).forEach( key => {\n\t\t\t\t\tif ( key === makeLegalIdentifier( key ) ) {\n\t\t\t\t\t\tvalidKeys.push( key );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinvalidKeys.push( key );\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlet char = 0;\n\t\t\t\tconst namedExports = validKeys.map( key => {\n\t\t\t\t\tconst declaration = `export var ${key} = ${JSON.stringify( data[ key ] )};`;\n\n\t\t\t\t\t// generate fake AST node while we're here\n\t\t\t\t\tast.body.push({\n\t\t\t\t\t\ttype: 'ExportNamedDeclaration',\n\t\t\t\t\t\tstart: char,\n\t\t\t\t\t\tend: declaration.length,\n\t\t\t\t\t\tdeclaration: {\n\t\t\t\t\t\t\ttype: 'VariableDeclaration',\n\t\t\t\t\t\t\tstart: char + 7,\n\t\t\t\t\t\t\tend: declaration.length,\n\t\t\t\t\t\t\tdeclarations: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: 'VariableDeclarator',\n\t\t\t\t\t\t\t\t\tstart: char + 11,\n\t\t\t\t\t\t\t\t\tend: declaration.length - 1,\n\t\t\t\t\t\t\t\t\tid: {\n\t\t\t\t\t\t\t\t\t\ttype: 'Identifier',\n\t\t\t\t\t\t\t\t\t\tstart: char + 11,\n\t\t\t\t\t\t\t\t\t\tend: char + 11 + key.length,\n\t\t\t\t\t\t\t\t\t\tname: key\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tinit: {\n\t\t\t\t\t\t\t\t\t\ttype: 'Literal',\n\t\t\t\t\t\t\t\t\t\tstart: char + 11 + key.length + 3,\n\t\t\t\t\t\t\t\t\t\tend: declaration.length - 1,\n\t\t\t\t\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\t\t\t\t\traw: 'null'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tkind: 'var'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tspecifiers: [],\n\t\t\t\t\t\tsource: null\n\t\t\t\t\t});\n\n\t\t\t\t\tchar += declaration.length + 1;\n\t\t\t\t\treturn declaration;\n\t\t\t\t});\n\n\t\t\t\tconst defaultExportNode = {\n\t\t\t\t\ttype: 'ExportDefaultDeclaration',\n\t\t\t\t\tstart: char,\n\t\t\t\t\tend: null,\n\t\t\t\t\tdeclaration: {\n\t\t\t\t\t\ttype: 'ObjectExpression',\n\t\t\t\t\t\tstart: char + 15,\n\t\t\t\t\t\tend: null,\n\t\t\t\t\t\tproperties: []\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tchar += 18; // 'export default {\\n\\t'.length'\n\n\t\t\t\tconst defaultExportRows = validKeys.map( key => {\n\t\t\t\t\tconst row = `${key}: ${key}`;\n\n\t\t\t\t\tdefaultExportNode.declaration.properties.push({\n\t\t\t\t\t\ttype: 'Property',\n\t\t\t\t\t\tstart: char,\n\t\t\t\t\t\tend: char + row.length,\n\t\t\t\t\t\tmethod: false,\n\t\t\t\t\t\tshorthand: false,\n\t\t\t\t\t\tcomputed: false,\n\t\t\t\t\t\tkey: {\n\t\t\t\t\t\t\ttype: 'Identifier',\n\t\t\t\t\t\t\tstart: char,\n\t\t\t\t\t\t\tend: key.length,\n\t\t\t\t\t\t\tname: key\n\t\t\t\t\t\t},\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\ttype: 'Identifier',\n\t\t\t\t\t\t\tstart: char + key.length + 2,\n\t\t\t\t\t\t\tend: char + row.length,\n\t\t\t\t\t\t\tname: key\n\t\t\t\t\t\t},\n\t\t\t\t\t\tkind: 'init'\n\t\t\t\t\t});\n\n\t\t\t\t\tchar += row.length + 3; // ',\\n\\t'.length\n\n\t\t\t\t\treturn row;\n\t\t\t\t}).concat( invalidKeys.map( key => `\"${key}\": ${JSON.stringify( data[ key ] )}` ) );\n\n\t\t\t\tconst defaultExportString = `export default {\\n\\t${defaultExportRows.join( ',\\n\\t' )}\\n};`;\n\n\t\t\t\tast.body.push( defaultExportNode );\n\t\t\t\tcode = `${namedExports.join( '\\n' )}\\n${defaultExportString}`;\n\n\t\t\t\tdefaultExportNode.end = defaultExportNode.declaration.end = code.length - 1;\n\t\t\t}\n\n\t\t\tast.end = code.length;\n\n\t\t\treturn { ast, code, map: { mappings: '' } };\n\t\t}\n\t};\n}\n"],"names":[],"mappings":"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"}